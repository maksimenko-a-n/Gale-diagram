\documentclass[12pt]{article}
\usepackage{cmap}
\usepackage[T2A]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage[russian]{babel}
\usepackage{amsmath,amsthm,amssymb}
%% Для рисунков
%\usepackage{graphicx}

\newcommand{\R}{\mathbb{R}}
\newcommand{\from}{\colon}
\DeclareMathOperator{\conv}{conv}

\sloppy

\begin{document}

\begin{center}
\large 
Руководство по работе с программой\\[0.5\baselineskip]
\textbf{Целочисленные диаграммы Гейла}\\[0.5\baselineskip]
\emph{Александр Максименко}\\
\end{center}


%\paragraph{Выпуклые $d$-мерные многогранники.}
Данная программа представляет собой инструмент для изучения комбинаторных свойств выпуклых $m$-мерных многогранников~\cite{Grunbaum:2003, Ziegler:2014}.
Каждый такой многогранник содержит грани различных размерностей от 0 до $m-1$.
Грани минимальной размерности, 0-грани, называются \emph{вершинами}.
Грани максимальной размерности, $(m-1)$-грани,
называются \emph{гипергранями} или \emph{фасетами}.
Грани размерности 1 называются \emph{ребрами}, 
а грани размерности $m-2$~--- \emph{гребнями} или \emph{риджами}.
Комбинаторный тип многогранника однозначно определяется его \emph{матрицей инциденций фасет"=вершин}. 
Множество строк этой матрицы находится во взаимно"=однозначном соответствии с множеством фасет многогранника, а множество её столбцов~--- с множеством вершин многогранника.
На пересечении $i$-ой строки и $j$-го столбца этой матрицы вписана единица, 
если $i$-я фасета многогранника содержит $j$-ю вершину,
в противном случае вписан ноль.

%\paragraph{Диаграмма Гейла.}
\emph{Диаграммой Гейла} называется конечное множество точек (векторов) $X$ в $\R^d$.
Причем одна и та же точка может присутствовать несколько раз (иметь кратность).
Хорошо известно~\cite{Grunbaum:2003, Ziegler:2014}, что каждому $m$-мерному выпуклому многограннику на $n$ вершинах $V$ может быть поставлена в соответствие диаграмма Гейла (множество точек) $X$ со следующими свойствами:
\begin{enumerate}
	\item Размерность $d$ диаграммы равна $n - m - 1$.
	\item Число точек в диаграмме совпадает с числом вершин многогранника, и между этими множествами установлено взаимно"=однозначное соответствие $\alpha\from V \to X$.
	\item При удалении любой (одной) точки из диаграммы Гейла выпуклая оболочка остальных точек имеет размерность $d$ и содержит начало координат в качестве внутренней точки. 
	\item Подмножество $F \subseteq V$ является множеством вершин некоторой грани многогранника $\conv(V)$ тогда, и только тогда, когда начало координат является относительной внутренней точкой выпуклой оболочки множества $Y = \alpha(V \setminus F)$, $Y \subseteq X$.
	В таком случае $Y$ называют \emph{когранью}.
\end{enumerate}
Более того, каждая диаграмма Гейла, удовлетворяющая третьему свойству, соответствует некоторому выпуклому многограннику с указанными выше свойствами.

Таким образом, если число вершин многогранника не сильно отличается от его размерности, то для изучения его комбинаторных свойств удобнее перейти к рассмотрению диаграммы Гейла, которая, при таких условиях, будет иметь небольшую размерность. Кроме того, как показывает опыт, именно такие случаи (когда число вершин не сильно отличается от размерности) представляют особый интерес в рамках комбинаторной теории выпуклых многогранников. 

\paragraph{Критерий кофасеты.}
Из перечисленных выше свойств диаграммы Гейла следует, что 
подмножество $F \subseteq V$ является множеством вершин некоторой фасеты многогранника $\conv(V)$ тогда, и только тогда, когда выпуклая оболочка множества $Y = \alpha(V \setminus F)$ является симплексом и содержит начало координат в качестве относительной внутренней точки.
Если последнее выполнено, то $Y$ называется \emph{кофасетой}.


\paragraph{Примеры.}
Если в качестве $X\subset \R^3$ взять множество вершин октаэдра:
\[
\begin{aligned}
x_1 &= (1, 0, 0), \\
x_2 &= (-1, 0, 0), \\
x_3 &= (0, 1, 0), \\
x_4 &= (0, -1, 0), \\
x_5 &= (0, 0, 1), \\
x_6 &= (0, 0, -1), 
\end{aligned}
\]
то такая диаграмма Гейла будет содержать ровно три кофасеты: $\{x_1, x_2\}$, $\{x_3, x_4\}$, $\{x_5, x_6\}$.
Но третье свойство для этой диаграммы не выполнено.
В частности, начало координат $(0, 0, 0)$ лежит на границе выпуклой оболочки множества $\{x_2, x_3, \dots, x_6\}$.
Это означает, что данная диаграмма не соответствует никакому выпуклому многограннику.

Рассмотрим теперь множество вершин шестиугольника в $\R^2$: 
\[
\begin{aligned}
x_1 &= (2,  1), \\
x_2 &= (2, -1), \\
x_3 &= (0, -2), \\
x_4 &= (-2, -1), \\
x_5 &= (-2,  1), \\
x_6 &= (0, 2).
\end{aligned}
\]
Такая диаграмма Гейла содержит пять кофасет:
$\{x_1, x_4\}$, $\{x_2, x_5\}$, $\{x_3, x_6\}$, $\{x_1, x_3, x_5\}$, $\{x_2, x_4, x_6\}$. Соответствующий ей трехмерный многогранник является призмой с треугольным основанием.

Диаграмме Гейла, образованной вершинами треугольника с кратностью два,
\[
\begin{aligned}
x_1 &= (1,  1), \\
x_2 &= (1,  1), \\
x_3 &= (1, -1), \\
x_4 &= (1, -1), \\
x_5 &= (-1, 0), \\
x_6 &= (-1, 0), \\
\end{aligned}
\]
соответствует трехмерный октаэдр, имеющий 6 вершин и 8 фасет: $\{x_1, x_3, x_5\}$, $\{x_1, x_3, x_6\}$, $\{x_1, x_4, x_5\}$, $\{x_1, x_4, x_6\}$, $\{x_2, x_3, x_5\}$, $\{x_2, x_3, x_6\}$, $\{x_2, x_4, x_5\}$, $\{x_2, x_4, x_6\}$. 


\paragraph{Цель программы:}
для заданной диаграммы Гейла (списка точек) найти все кофасеты и выяснить, соответствует ли данная диаграмма какому-нибудь выпуклому многограннику (выполняется ли свойство 3).

\paragraph{Основная идея реализации.}
Рассмотрим подмножество точек $Y = \{y^1, \dots, y^k\}$ диаграммы $X$.
Из описанного выше критерия кофасеты следует, что $Y$ является кофасетой тогда, и только тогда, когда система
\begin{align*}
x_1 y^1 + \dots + x_k y^k &= 0, \\
x_1 + \dots + x_k &= 1,
\end{align*}
имеет единственное решение и $x_i > 0$, $i \in [k]$.
(Более того, никакое подмножество множества $Y$ этому условию не удовлетворяет.)
Такая проверка может быть выполнена, например, с помощью метода Гаусса для решения систем линейных уравнений.

Та же идея используется и для проверки третьего свойства диаграммы Гейла. А именно, пусть $x$ "--- одна из точек диаграммы Гейла и $Y = X \setminus \{x\}$.
Воспользуемся тем, что вершина $\alpha^{-1}(x)$ многогранника 
$\conv(V)$ должна быть пересечением как минимум $m$ фасет, где $m = n - d - 1$ "--- размерность многогранника. Предположим, что все фасеты (точнее, множества их вершин) уже найдены на предыдущем шаге. Выберем из них те, что содержат тестируемую вершину $\alpha^{-1}(x)$. Если их число оказалось меньше $n - d - 1$, то эта диаграмма не может соответствовать выпуклому многограннику. Если же их не меньше, чем $n - d - 1$, то остается убедиться в том, что система векторов из $Y$ имеет ранг не менее $d$. Это можно сделать с помощью того же метода Гаусса, располагая вектора множества $Y$ в строках соответствующей матрицы.

\paragraph{Формат входных данных.}
Во входном файле, содержащем диаграмму Гейла, первая строка содержит два целых числа, разделенных пробелом(ами): размерность диаграммы и число точек в ней. Далее идет список точек. Описание каждой точки занимает одну строку и представляет собой несколько целых чисел (координат точки), разделенных пробелами. На значения входных данных накладываются следующие ограничения:
\begin{enumerate}
	\item Все числа целые. Никакие символы, кроме цифр и пробельных символов (переводов строки, табуляций) недопустимы.
	\item Размерность диаграммы не может быть больше 16 (константа \texttt{MAX\_DIM} в коде программы)\footnote{Эксперименты с программой показали, что для обработки реалистичных примеров диаграмм с размерностью 16 и больше программе потребуется не менее нескольких часов работы.}. 
	\item Число точек не может быть больше 64 (особенность реализации, связанная с разрядностью большинства современных операционных систем).
	\item Значения координат точек не могут быть по абсолютной величине больше, чем 2 (константа \texttt{MAX\_NUMBERS} в коде программы). Эта константа может быть на несколько порядков увеличена, если размерность обрабатываемых диаграмм невелика.
\end{enumerate}
Пример входного файла, содержащего вершины шестиугольника:
\begin{verbatim}
2 6
 2  1
 2 -1
 0 -2
-2 -1
-2  1
 0  2
\end{verbatim}

\paragraph{Работа с программой.}
Программа написана на языке С++ и, в случае использования компилятора GNU, собирается следующей командой:
\begin{verbatim}
g++ gale-main.cpp gale-diagram.cpp -o gale
\end{verbatim}
Единственным параметром получившегося исполняемого файла \texttt{gale.exe} является имя файла, содержащего описание диаграммы Гейла. Пример использования:
\begin{verbatim}
gale 2d6v.g
\end{verbatim}

Результат работы программы с параметром типа \texttt{filename.ext} сохраняется в файл \texttt{filename.ext.out}. Формат и способ вывода результатов работы программы может быть скорректирован вручную в основном файле \texttt{gale-main.cpp}. В текущей версии в выходной файл сохраняется:
\begin{enumerate}
	\item Описание диаграммы в исходном виде.
	\item Список множеств вершин, образующих фасеты.
	\item Матрица инциденций фасет"=вершин.
	\item Если диаграмма не соответствует никакому выпуклому многограннику, то выводится номер первой точки, для которой не выполнено третье свойство диаграммы Гейла и файл заканчивается надписью	\texttt{This is not convex polytope!}
	\item Далее выводится число риджей и список ребер многогранника.
\end{enumerate}  

\paragraph{Дополнения.}
Для тестирования данной программы написана программа \texttt{genexamples.cpp}, генерирующая несколько примеров диаграмм Гейла. Список команд для её компиляции, запуска и обработки сгенерированных примеров содержится в файле \texttt{test.bat}.

\begin{thebibliography}{9}
    
\bibitem{Grunbaum:2003} 
Gr\"unbaum B.
Convex polytopes. Second edition.
Springer, 2003. 
 
\bibitem{Ziegler:2014} 
Циглер Г.М. 
Теория многогранников: Пер. с англ. / Под ред. Н.П. Долбилина. М.: МЦНМО, 2014. 

\end{thebibliography}

\end{document}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%   Конец
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

